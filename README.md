# OCR‑PDF

## Описание

Небольшой локальный сервис на FastAPI, который позволяет:

* Загружать PDF-документы
* Преобразовывать страницы в изображения
* Распознавать текст с помощью EasyOCR / PyMuPDF
* Выгружать результат в формате **TXT** и **JSON**

Проект готов к развёртыванию на Windows, Linux и macOS без дополнительных зависимостей помимо Python.

---

## Требования

* Python 3.9+
* Git

> Все зависимости **зафиксированы** в `requirements.txt`.
> Используйте именно эти версии, чтобы избежать проблем с совместимостью.

---

## Установка

```bash
# Клонировать репозиторий
git clone https://github.com/<username>/practice-main.git
cd practice-main

# Создать виртуальное окружение
python -m venv venv

# Активировать окружение
# Windows:
venv\Scripts\activate.bat
# Linux/macOS:
source venv/bin/activate

# Установить зависимости
pip install --upgrade pip
pip install -r requirements.txt  # устанавливаем строго зафиксированные версии
```

---

## Запуск

```bash
uvicorn app.main:app --reload
```

Откройте в браузере [http://127.0.0.1:8000](http://127.0.0.1:8000).

---

## Использование

1. На главной странице выберите PDF.
2. Выберите модель распознавания (EasyOCR CPU/GPU или RolmOCR CPU/GPU).
3. Нажмите **Отправить**.
4. Дождитесь обработки и перейдите на страницу результата.
5. Скачайте файлы:

   * `result.txt` – чистый текст
   * `result.json` – массив объектов `{ bbox, text, confidence }`

---

## Отличия моделей

**EasyOCR** — лёгкая модель для быстрого OCR русских и английских текстов. Вариант
на GPU просто использует видеокарту для ускорения. На CPU работает немного
медленнее, но требует меньше ресурсов.

**RolmOCR** заметно крупнее (≈12 ГБ) и точнее извлекает текст, особенно из
нечётких изображений. В режиме GPU модель целиком загружается в память
видеокарты. На CPU она тоже запускается, но подготовка и распознавание могут
занимать существенно больше времени.

---

## Структура проекта

```
app/             # исходный код FastAPI
templates/       # Jinja2‑шаблоны (index.html, result.html, base.html)
static/          # CSS и JS
results/         # папка с результатами OCR
scripts/         # вспомогательные скрипты
venv/            # виртуальное окружение (игнорируется)
requirements.txt # зафиксированные зависимости
Dockerfile       # конфигурация контейнера
README.md        # эта инструкция
```

---

## Получение примеров

Примерные PDF не включены в репозиторий. Чтобы скачать их в папку `pdf/`, выполните:

```bash
bash scripts/download_examples.sh
```

После выполнения скрипта в каталоге `pdf/` появятся несколько открытых статей с arXiv, которые можно использовать для тестирования.

---

## Тестирование

```bash
pytest -q
```

> В каталоге имеется упрощённый пакет `fastapi_stub`, который используется **только** для запуска тестов. Для реального запуска приложения требуется установить полноценный FastAPI из `requirements.txt`.

---

## Лицензия

MIT © Dmitriy Kuznetsov
